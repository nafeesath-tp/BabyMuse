{% extends "core/base.html" %}
{% load static %}
{% load form_tags %}

{% block extra_meta %}
  <meta http-equiv="Cache-Control" content="no-store" />
{% endblock %}

{% block content %}
<section class="max-w-xl mx-auto py-10 px-4">
  <h2 class="text-3xl font-bold text-center text-gray-800 mb-6">ðŸ‘¤ Edit Profile</h2>

  <div class="bg-white p-6 rounded-xl shadow-md">
    {% if messages %}
      {% for message in messages %}
        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-2 rounded mb-4 shadow">
          {{ message }}
        </div>
      {% endfor %}
    {% endif %}

    <form method="POST" enctype="multipart/form-data" class="space-y-4">
      {% csrf_token %}
      {{ form.non_field_errors }}

      <!-- First Name -->
      <label class="block font-medium">First Name:</label>
      {{ form.first_name|add_class:"w-full mb-1 border px-4 py-2 rounded" }}
      {% for error in form.first_name.errors %}
        <p class="text-sm text-red-600">{{ error }}</p>
      {% endfor %}

      <!-- Last Name -->
      <label class="block font-medium">Last Name:</label>
      {{ form.last_name|add_class:"w-full mb-1 border px-4 py-2 rounded" }}
      {% for error in form.last_name.errors %}
        <p class="text-sm text-red-600">{{ error }}</p>
      {% endfor %}

      <!-- Email (with note) -->
      <label class="block font-medium">Email:</label>
      {{ form.email|add_class:"w-full mb-1 border px-4 py-2 rounded" }}
      
      {% for error in form.email.errors %}
        <p class="text-sm text-red-600">{{ error }}</p>
      {% endfor %}

      <!-- Phone -->
      <label class="block font-medium">Phone:</label>
      {{ form.phone|add_class:"w-full mb-1 border px-4 py-2 rounded" }}
      {% for error in form.phone.errors %}
        <p class="text-sm text-red-600">{{ error }}</p>
      {% endfor %}

      <!-- Profile Image Preview -->
      <label class="block font-medium">Profile Image:</label>
      <img id="imagePreview"
           src="{% if request.user.profile_image %}{{ request.user.profile_image.url }}{% else %}{% static 'images/default-avatar.png' %}{% endif %}"
           class="h-20 w-20 rounded-full object-cover mb-2"
           alt="Profile Image" />

      <!-- Upload New -->
      <label for="id_profile_image" class="block font-medium">Change Profile Image:</label>
      {{ form.profile_image }}
      {% for error in form.profile_image.errors %}
        <p class="text-sm text-red-600">{{ error }}</p>
      {% endfor %}

      <!-- Submit -->
      <div class="pt-4">
        <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded shadow">
          ðŸ’¾ Save Changes
        </button>
      </div>
    </form>
  </div>
</section>
{% endblock %}